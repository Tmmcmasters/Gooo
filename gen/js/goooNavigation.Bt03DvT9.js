import{s as L}from"./reactivity.esm-bundler.VNJZQcYl.js";const Q=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,H=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,M=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function J(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){B(e);return}return t}function B(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function G(e,t={}){if(typeof e!="string")return e;if(e[0]==='"'&&e[e.length-1]==='"'&&e.indexOf("\\")===-1)return e.slice(1,-1);const r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!M.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(Q.test(e)||H.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,J)}return JSON.parse(e)}catch(s){if(t.strict)throw s;return e}}const K=/#/g,W=/&/g,k=/\//g,z=/=/g,S=/\+/g,V=/%5e/gi,X=/%60/gi,Y=/%7c/gi,Z=/%20/gi;function x(e){return encodeURI(""+e).replace(Y,"|")}function b(e){return x(typeof e=="string"?e:JSON.stringify(e)).replace(S,"%2B").replace(Z,"+").replace(K,"%23").replace(W,"%26").replace(X,"`").replace(V,"^").replace(k,"%2F")}function E(e){return b(e).replace(z,"%3D")}function N(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function ee(e){return N(e.replace(S," "))}function te(e){return N(e.replace(S," "))}function oe(e=""){const t=Object.create(null);e[0]==="?"&&(e=e.slice(1));for(const r of e.split("&")){const s=r.match(/([^=]+)=?(.*)/)||[];if(s.length<2)continue;const n=ee(s[1]);if(n==="__proto__"||n==="constructor")continue;const c=te(s[2]||"");t[n]===void 0?t[n]=c:Array.isArray(t[n])?t[n].push(c):t[n]=[t[n],c]}return t}function re(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(r=>`${E(e)}=${b(r)}`).join("&"):`${E(e)}=${b(t)}`:E(e)}function se(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>re(t,e[t])).filter(Boolean).join("&")}const ne=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,ae=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,ce=/^([/\\]\s*){2,}[^/\\]/,ie=/^\.?\//;function q(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?ne.test(e):ae.test(e)||(t.acceptRelative?ce.test(e):!1)}function pe(e="",t){return e.endsWith("/")}function ue(e="",t){return(pe(e)?e.slice(0,-1):e)||"/"}function fe(e="",t){return e.endsWith("/")?e:e+"/"}function le(e,t){if(ye(t)||q(e))return e;const r=ue(t);return e.startsWith(r)?e:me(r,e)}function he(e,t){const r=we(e),s={...oe(r.search),...t};return r.search=se(s),ge(r)}function ye(e){return!e||e==="/"}function de(e){return e&&e!=="/"}function me(e,...t){let r=e||"";for(const s of t.filter(n=>de(n)))if(r){const n=s.replace(ie,"");r=fe(r)+n}else r=s;return r}const O=Symbol.for("ufo:protocolRelative");function we(e="",t){const r=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){const[,f,h=""]=r;return{protocol:f.toLowerCase(),pathname:h,href:f+h,auth:"",host:"",search:"",hash:""}}if(!q(e,{acceptRelative:!0}))return _(e);const[,s="",n,c=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,u="",a=""]=c.match(/([^#/?]*)(.*)?/)||[];s==="file:"&&(a=a.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:i,search:l,hash:o}=_(a);return{protocol:s.toLowerCase(),auth:n?n.slice(0,Math.max(0,n.length-1)):"",host:u,pathname:i,search:l,hash:o,[O]:!s}}function _(e=""){const[t="",r="",s=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:r,hash:s}}function ge(e){const t=e.pathname||"",r=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",s=e.hash||"",n=e.auth?e.auth+"@":"",c=e.host||"";return(e.protocol||e[O]?(e.protocol||"")+"//":"")+n+c+t+r+s}class Ee extends Error{constructor(t,r){super(t,r),this.name="FetchError",r!=null&&r.cause&&!this.cause&&(this.cause=r.cause)}}function be(e){var i,l,o,f,h;const t=((i=e.error)==null?void 0:i.message)||((l=e.error)==null?void 0:l.toString())||"",r=((o=e.request)==null?void 0:o.method)||((f=e.options)==null?void 0:f.method)||"GET",s=((h=e.request)==null?void 0:h.url)||String(e.request)||"/",n=`[${r}] ${JSON.stringify(s)}`,c=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",u=`${n}: ${c}${t?` ${t}`:""}`,a=new Ee(u,e.error?{cause:e.error}:void 0);for(const p of["request","options","response"])Object.defineProperty(a,p,{get(){return e[p]}});for(const[p,d]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(a,p,{get(){return e.response&&e.response[d]}});return a}const Re=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function A(e="GET"){return Re.has(e.toUpperCase())}function Se(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const Te=new Set(["image/svg","application/xml","application/xhtml","application/html"]),_e=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Ae(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return _e.test(t)?"json":Te.has(t)||t.startsWith("text/")?"text":"blob"}function Ce(e,t,r,s){const n=Pe((t==null?void 0:t.headers)??(e==null?void 0:e.headers),r==null?void 0:r.headers,s);let c;return(r!=null&&r.query||r!=null&&r.params||t!=null&&t.params||t!=null&&t.query)&&(c={...r==null?void 0:r.params,...r==null?void 0:r.query,...t==null?void 0:t.params,...t==null?void 0:t.query}),{...r,...t,query:c,params:c,headers:n}}function Pe(e,t,r){if(!t)return new r(e);const s=new r(t);if(e)for(const[n,c]of Symbol.iterator in e||Array.isArray(e)?e:new r(e))s.set(n,c);return s}async function w(e,t){if(t)if(Array.isArray(t))for(const r of t)await r(e);else await t(e)}const Le=new Set([408,409,425,429,500,502,503,504]),Ne=new Set([101,204,205,304]);function j(e={}){const{fetch:t=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:s=globalThis.AbortController}=e;async function n(a){const i=a.error&&a.error.name==="AbortError"&&!a.options.timeout||!1;if(a.options.retry!==!1&&!i){let o;typeof a.options.retry=="number"?o=a.options.retry:o=A(a.options.method)?0:1;const f=a.response&&a.response.status||500;if(o>0&&(Array.isArray(a.options.retryStatusCodes)?a.options.retryStatusCodes.includes(f):Le.has(f))){const h=typeof a.options.retryDelay=="function"?a.options.retryDelay(a):a.options.retryDelay||0;return h>0&&await new Promise(p=>setTimeout(p,h)),c(a.request,{...a.options,retry:o-1})}}const l=be(a);throw Error.captureStackTrace&&Error.captureStackTrace(l,c),l}const c=async function(i,l={}){const o={request:i,options:Ce(i,l,e.defaults,r),response:void 0,error:void 0};o.options.method&&(o.options.method=o.options.method.toUpperCase()),o.options.onRequest&&await w(o,o.options.onRequest),typeof o.request=="string"&&(o.options.baseURL&&(o.request=le(o.request,o.options.baseURL)),o.options.query&&(o.request=he(o.request,o.options.query),delete o.options.query),"query"in o.options&&delete o.options.query,"params"in o.options&&delete o.options.params),o.options.body&&A(o.options.method)&&(Se(o.options.body)?(o.options.body=typeof o.options.body=="string"?o.options.body:JSON.stringify(o.options.body),o.options.headers=new r(o.options.headers||{}),o.options.headers.has("content-type")||o.options.headers.set("content-type","application/json"),o.options.headers.has("accept")||o.options.headers.set("accept","application/json")):("pipeTo"in o.options.body&&typeof o.options.body.pipeTo=="function"||typeof o.options.body.pipe=="function")&&("duplex"in o.options||(o.options.duplex="half")));let f;if(!o.options.signal&&o.options.timeout){const p=new s;f=setTimeout(()=>{const d=new Error("[TimeoutError]: The operation was aborted due to timeout");d.name="TimeoutError",d.code=23,p.abort(d)},o.options.timeout),o.options.signal=p.signal}try{o.response=await t(o.request,o.options)}catch(p){return o.error=p,o.options.onRequestError&&await w(o,o.options.onRequestError),await n(o)}finally{f&&clearTimeout(f)}if((o.response.body||o.response._bodyInit)&&!Ne.has(o.response.status)&&o.options.method!=="HEAD"){const p=(o.options.parseResponse?"json":o.options.responseType)||Ae(o.response.headers.get("content-type")||"");switch(p){case"json":{const d=await o.response.text(),v=o.options.parseResponse||G;o.response._data=v(d);break}case"stream":{o.response._data=o.response.body||o.response._bodyInit;break}default:o.response._data=await o.response[p]()}}return o.options.onResponse&&await w(o,o.options.onResponse),!o.options.ignoreResponseError&&o.response.status>=400&&o.response.status<600?(o.options.onResponseError&&await w(o,o.options.onResponseError),await n(o)):o.response},u=async function(i,l){return(await c(i,l))._data};return u.raw=c,u.native=(...a)=>t(...a),u.create=(a={},i={})=>j({...e,...i,defaults:{...e.defaults,...i.defaults,...a}}),u}const g=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),qe=g.fetch?(...e)=>g.fetch(...e):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),Oe=g.Headers,je=g.AbortController,Ie=j({fetch:qe,Headers:Oe,AbortController:je}),$e=Ie;window.fileRegistry??(window.fileRegistry=new Map);const m=new Set,y=L("idle"),I=L(window.location.pathname);let C=!1;const T=e=>$e(e,{method:"GET",headers:{Accept:"text/html"},onRequest:()=>{y.value="pending"},onResponse:({response:t})=>{y.value=t.ok?"success":"error"},onResponseError:()=>{y.value="error"}}),$=e=>{const t=document.createElement("script");return t.setAttribute("data-page-script","true"),t.type=e.type||"text/javascript",t.async=!1,e.src?t.src=e.src:t.textContent=e.textContent,t},Fe=e=>{document.querySelectorAll("script[data-page-script]").forEach(t=>t.remove()),e.querySelectorAll("script[data-page-script]").forEach(t=>{const r=t,s=r.src&&new URL(r.src,location.origin).pathname;(!r.src||!m.has(s))&&(s&&m.add(s),document.body.appendChild($(r)))})},F=async e=>{e.querySelectorAll("script[data-page-script]").forEach(t=>{var c,u;const r=t,s=r.src&&new URL(r.src,location.origin).pathname,n=(c=window.fileRegistry)==null?void 0:c.get(s);r.src&&m.has(s)&&(n!=null&&n.hydrate)?(n.hydrate(),r.remove()):(s&&m.add(s),(u=r.parentNode)==null||u.replaceChild($(r),r))})},U=e=>new DOMParser().parseFromString(e,"text/html"),D=(e,t=!0,r="")=>{const s=e.querySelector("[gooo-layout]");if(!s)return console.error("Missing [gooo-layout]"),console.error(e.documentElement.outerHTML),y.value="error",location.href=r,!1;const n=document.querySelector("[gooo-layout]");return n==null||n.replaceWith(s),t&&history.pushState({url:r},e.title??document.title,r),I.value=r,s},R=new Map,ve=async e=>{if(!R.has(e))try{const t=await T(e);R.set(e,t)}catch(t){console.warn(`Prefetch failed for ${e}`,t)}},Qe=async e=>{try{const t=R.get(e),s=t!==void 0?t:await T(e),n=U(s);if(!D(n,!0,e))return;F(document.documentElement),Fe(n),y.value="success"}catch(t){console.error("Navigation error:",t),y.value="error",location.href=e}},P=async()=>{const e=location.pathname;if(e!==I.value){y.value="pending";try{const t=await T(e),r=U(t),s=D(r,!1,e);if(!s)return;F(s),history.replaceState({url:e},r.title??document.title,e),y.value="success"}catch(t){console.error("Popstate error:",t),y.value="error",location.href=e}}},Ue=()=>{C||(C=!0,document.querySelectorAll("script[data-page-script]").forEach(e=>{const t=new URL(e.src,location.origin).pathname;m.add(t)}),addEventListener("popstate",P),addEventListener("unload",()=>removeEventListener("popstate",P)))};Ue();export{Qe as n,ve as p};
